*, MMSI||'_'||CUM_SUM MMSI2
FROM (SELECT *, SUM(CASE_DIFF) OVER(PARTITION BY MMSI ORDER BY ETA ROWS UNBOUNDED PRECEDING) CUM_SUM
	  FROM (SELECT *, CASE WHEN DATE_DIFF < 2 THEN 0 ELSE 1 END CASE_DIFF
			FROM (SELECT *, DATEDIFF(ETA, ETA2) DATE_DIFF
				  FROM (SELECT *, LAG(ETA, 1) OVER(PARTITION BY MMSI ORDER BY ETA) ETA2
						FROM #{DF(0)}))))
